<div class="row-fluid">
  <div class="span12">
    <div class="header">
      <h1><%= @school.name %></h1>
      <%= link_to 'Edit', edit_school_path(@school), class: "btn btn-primary" %>
    </div>

    <dl>
      <dt>Region</dt>
      <dd><%= @school.region.try(:name) %></dd>

      <dt>Community Partners</dt>
      <dd><%= @school.community_partners.count %></dd>

      <dt>School Quality Indicator Sub Areas Covered</dt>
      <dd><%= school_quality_indicator_sub_area_display(@school) %></dd>
    </dl>

    <div class="table_wrapper span6">
      <h2>School Quality Indicator Sub Areas</h2>

      <table class="table table-striped">
        <thead>
          <tr>
            <th>School Quality Indicator Sub Area</th>
            <th class="center">Community Partners</th>
          </tr>
        </thead>

        <tbody>
          <% SchoolQualityIndicatorSubArea.all.each do |indicator| %>
            <tr>
              <td><%= link_to indicator.try(:name), school_quality_indicator_sub_area_path(indicator) %></td>
              <td class="center">
                <%= community_partner_count_for_indictor(indicator, @school) %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>

    <div class="table_wrapper span10">
      <h2>Community Partners</h2>

      <table class="table table-striped table-sorter">
        <thead>
          <tr>
            <th>Organization</th>
            <th class="center">School Quality Indicator Sub Area</th>
            <th class="center">Service Type</th>
          </tr>
        </thead>

        <tbody>
          <% @school.community_partners.each do |community_partner| %>
            <tr>
              <td><%= link_to community_partner.organization.try(:name), community_partner_path(community_partner) %></td>
              <td class="center"><%= community_partner.service_type.try(:name) %></td>
              <td class="center"><%= community_partner.school_quality_indicator_sub_area.try(:name) %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>

  </div>
</div>
