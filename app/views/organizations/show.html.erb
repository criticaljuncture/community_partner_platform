<%= breadcrumb [['Partner Organizations', organizations_path], [@organization.name, organization_path(@organization)]] %>

<div class="row-fluid">
  <div class="span12">
    <div class="header">
      <h1><%= @organization.name %></h1>
      <%= link_to('Edit', edit_organization_path(@organization), class: "btn btn-primary") if can?(:update, @organization) %>
    </div>

    <div class="table_wrapper">
     <table class="table table-striped table-hover">
      <thead>
        <tr>
          <th>School</th>
          <th>Community School Element</th>
          <th>Service Types</th>
        </tr>
      </thead>

      <tbody>
        <% @community_partnerships.group_by(&:school).each do |school, community_partnerships| %>
          <% community_partnerships.each do |community_partnership| %>
          <tr>
            <td><%= link_to school.try(:name), school_path(school) %></td>
            <td><%= community_partnership.quality_elements.map{|qe| qe.name}.join(', <br />').html_safe %></td>
            <td><%= community_partnership.service_types.map{|st| st.name}.join(', <br />').html_safe %></td>
          </tr>
          <% end %>
        <% end %>
      </tbody>
    </table> 
    </div>
    
  </div>
</div>
